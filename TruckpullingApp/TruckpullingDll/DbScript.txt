

DROP TABLE IF EXISTS PullingPull;
DROP TABLE IF EXISTS PullingTruck;
DROP TABLE IF EXISTS PullingRaceRound;
DROP TABLE IF EXISTS PullingRace;
DROP TABLE IF EXISTS PullingSeason;
DROP TABLE IF EXISTS PullingClass;
DROP TABLE IF EXISTS PullingOrganization;


CREATE TABLE IF NOT EXISTS PullingTruck (
	Id INT AUTO_INCREMENT,
	Name VARCHAR(255) NOT NULL,
	PRIMARY KEY(Id)
);

CREATE TABLE IF NOT EXISTS PullingOrganization (
	Id INT AUTO_INCREMENT,
	Name VARCHAR(255) NOT NULL,
	PRIMARY KEY (Id),
	UNIQUE(Name)
);

CREATE TABLE IF NOT EXISTS PullingClass (
	Id INT AUTO_INCREMENT,
	Name VARCHAR(255) NOT NULL,
	MaxMassKg INT NOT NULL,
	OrganizationId INT NOT NULL,
	PRIMARY KEY(Id),
	FOREIGN KEY(OrganizationId) REFERENCES PullingOrganization(Id) ON UPDATE RESTRICT ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS PullingSeason (
	Id INT AUTO_INCREMENT,
	Year INT NOT NULL,
	ClassId INT NOT NULL,
	PRIMARY KEY(Id),
	FOREIGN KEY(ClassId) REFERENCES PullingClass(Id) ON UPDATE RESTRICT ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS PullingRace (
	Id INT AUTO_INCREMENT,
	EventName VARCHAR(255) NOT NULL,
	Address VARCHAR(255),
	SeasonId INT NOT NULL,
	PRIMARY KEY(Id),
	FOREIGN KEY(SeasonId) REFERENCES PullingSeason(Id) ON UPDATE RESTRICT ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS PullingRaceRound (
	Id INT AUTO_INCREMENT,
	RoundNumber FLOAT NOT NULL,
	FullPullThreshold INT,
	RaceId INT NOT NULL,
	PRIMARY KEY(Id),
	FOREIGN KEY(RaceId) REFERENCES PullingRace(Id) ON UPDATE RESTRICT ON DELETE CASCADE
);


CREATE TABLE IF NOT EXISTS PullingPull (
	Id INT AUTO_INCREMENT,
	RoundId INT NOT NULL,
	TruckId INT NOT NULL,
	PRIMARY KEY(Id),
	FOREIGN KEY(RoundId) REFERENCES PullingRaceRound(Id) ON UPDATE RESTRICT ON DELETE CASCADE,
	FOREIGN KEY(TruckId) REFERENCES PullingTruck(Id) ON UPDATE RESTRICT ON DELETE CASCADE
);
